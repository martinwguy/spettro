------------------------------------------------------------------------
Make playing multiple audio files work.

We'll do this by displaying all the files concatenated together into one
long spectrogram, which means opening them all at startup to find the
overall length
TODO:
- files with different sampling rates - impact on audio player
- modify KEY_P to show time into the audio file if multiple.
- eliminate global speclen
  paint.c:336: presumably, speclen needs to be per-file due to different
  sampling rates in different files.
  It depends on the samping rate and fft_freq, so is different for each
  audio file, even with the same fft_freq.
  Speclen is already in calc_t and result_t, so needs to be calculated when
  a calc is scheduled, to get rid of the global speclen.
- Bind "Prev" and "Next" to 'p' and 'n' and make them do previous/next track.
- Also mention |<< and >>| media keys in the manual.
------------------------------------------------------------------------
Be able to position the green line, disp_offset,
and also move it with Ctrl-Shift-Left/Right arrow, Home, End?
------------------------------------------------------------------------
Be able to display audio from a live source, presumably with the green
line on the right edge.
------------------------------------------------------------------------
Cancel scheduled calculations that are no longer in the area of interest
------------------------------------------------------------------------
Keep track of which calculations are in-flight, to avoid duplicate calcs.
Can we kill an in-flight FFT if it goes off-screen (and not in lookahead)?
------------------------------------------------------------------------
Full-piece spectrogram in miniature along the bottom edge so that you can
seek to any position in a click and see which parts have been calculated.
------------------------------------------------------------------------
Do subpixel positioning of bar lines / antialiasing.
------------------------------------------------------------------------
Option to synch scrolling to real time not playing-time (--smooth option?)
by scrolling the graphics in response to a periodic timer instead of
by the sound player's current position.
Synch is good if I remember, with the reposition-ELF-on-resume tweak,
------------------------------------------------------------------------
Add -m mute flag to be able to test emotion graphics when sound is broken
or to give just the graphics if initializing the audio output fails.
This needs the above "synch scrolling".
------------------------------------------------------------------------
Try playing sound with SDL_Mixer (Ogg, MP3)
Mix_RewindMusic(); Mix_SetMusicPosition(double position)
(works with WAV and FLAC?)
Mix_FadeInMusicos(Mix_Music *music, 1, fade_ms, double position)
Mix_SetMusicCMD("mpg123")
------------------------------------------------------------------------
When adding score lines when there were none, just draw them on the display
instead of redisplaying the columns' spectral data.
When removing/changing such lines, just repaint the appropriate rows
------------------------------------------------------------------------
Give configure --with flags instead of Makefile's USE_ stuff.
------------------------------------------------------------------------
Move toolkit-specific stuff each to their own file.
------------------------------------------------------------------------
Be able to change disp_height and disp_width while running, so that
GUI window resizing becomes possible.
Check make_row_overlay()
------------------------------------------------------------------------
Should speclen be > (sample_rate/2)/fft_freq instead of near to it?
------------------------------------------------------------------------
Keep settings from one run to another (softvol, fftfreq etc)
------------------------------------------------------------------------
'-t' can be > audio_length, but check that emotion_set_time() > length works.
------------------------------------------------------------------------
Change Makefile flags to USE_SDL1/USE_SDL2
------------------------------------------------------------------------
On frequency axis, add single digit 8 or whatever at the unnumbered ticks
and/or increse the number of numbers according to the height of the graph.
-or-
Be able to increase the number of labels/divisions on the frequency axis
------------------------------------------------------------------------
Add test suite using PNG output
------------------------------------------------------------------------
Give the failure reason in an exit status
------------------------------------------------------------------------
Convert html to man page
------------------------------------------------------------------------
Be able to set spectrogram size in pixels or in seconds/frequency range.
There's already min-max freq, allow min/max, min/range max/range or
center/range.
------------------------------------------------------------------------
Recognise note names A0 in -n -x and the above.
------------------------------------------------------------------------
Make a ui struct of the parameters visible in main.c
------------------------------------------------------------------------
When zoomed in a lot, print enough digits on frequency axis to reveal
the digit that changes per tick.
------------------------------------------------------------------------
Make the desktop icon appear in the window manager.
------------------------------------------------------------------------
Make Ctrl-left click play from here.
------------------------------------------------------------------------
Decode compressed audio front-to-back without seeking
------------------------------------------------------------------------
With libav, only cache compressed formats.
------------------------------------------------------------------------
Be able to save the audio fragment between left and right as a WAV file.
------------------------------------------------------------------------
Be able to play the l-r selection
Ctrl-L: play from left bar marker, then stop
Shift-L or C-S-L: play from left bar marker, then repeat
Ctrl-R: play from right bar marker onwards
------------------------------------------------------------------------
Compile the Enlightenment port for Android, iOS and Windows!
------------------------------------------------------------------------
Pressing the same overlay key again cycles through white, black, none.
Do the same for bar lines. Save last_key_pressed?
------------------------------------------------------------------------
Add failure return values from libav_open_audio_file() and libmpg123_*()
------------------------------------------------------------------------
In audio file reading, convert mono doubles to mono floats.
------------------------------------------------------------------------
Be able to tune A to a different frequency & up/down it via the GUI.
Or cmdline --tune A4=440.
If no octave given, --tune F#=710 retune the nearest F# to 710. (+ais aes)
------------------------------------------------------------------------
Status bar: show lbar rbar beats audio_length srate channels
------------------------------------------------------------------------
Something to show how far through the file you are (like a scroll bar)
------------------------------------------------------------------------
Use floating-point decoder libraries MP3 files' mono-double output and
see if the output is less noisy like http://i.imgur.com/DxnNBwM.jpg
------------------------------------------------------------------------
Implement Chloropleth maps https://en.wikipedia.org/wiki/Choropleth_map
------------------------------------------------------------------------
Option to turn the green line off for screencaps of nicely positioned
spectrograms (ok, there is -o too)
------------------------------------------------------------------------
Scroll the graphic up and down when they scroll the mouse wheel.
------------------------------------------------------------------------
Make Ctrl-O read in a new audio file from disc.
------------------------------------------------------------------------
Make Ctrl-N or > make it skip to the next file.
------------------------------------------------------------------------
Respond to stdin keystrokes as well - maybe solves the CAPS and CACA probs.
------------------------------------------------------------------------
Make 'Y' and 'y' zoom in by less than a factor of two, say a tenth of
the screen height, like the default time pan, or by one octave like the
frequency pan.
------------------------------------------------------------------------
Make Ctrl 'x' and 'X' zoom by one pixel.
------------------------------------------------------------------------
Add command-line flag to set overlay colors.
------------------------------------------------------------------------
Add finer FFT frequency control with Ctrl (and change the Fullscreen key)
------------------------------------------------------------------------
When scrolling to playing position, take into account the timer interval
to position the display at the middle of the forthcoming timer interval.
Currently it syncs to the playing time, which then moves ahead so it
lags a little.
------------------------------------------------------------------------
Convert all doubles to floats, to save space (?) and on ARM registers
in fn params?
------------------------------------------------------------------------
Make Ctrl-g/G do bass guitar strings instead of EADGBE.
------------------------------------------------------------------------
Show the time of the end of the piece on the time scale
------------------------------------------------------------------------
Be able to give command-line time parameters as 1:30.62
------------------------------------------------------------------------
Be able to set the colour of the staff/guitar/piano lines at startup.
------------------------------------------------------------------------
Remove Ctrl from mouse-bar-line setting, bcos on a mousepad they will want
one finger to hold the button pressed and the other to move the pointer.
Ctrl needs three fingers instad of two.
------------------------------------------------------------------------
Detect MP3 format from file hdr, not file name.
------------------------------------------------------------------------
Add a white-backgrounded heat map for color printers.
------------------------------------------------------------------------
Use red and green as real and imaginary
------------------------------------------------------------------------
Be able to resynthesize the audio from the spectrogram
------------------------------------------------------------------------
Be able to load a spectrogram (and play it!)
------------------------------------------------------------------------
Entire spectrogram as a data structure, not cached results,
result-calculated when required and cached in each entry in the
gram. Changing PPSEC would have to rewrite the gram data structure,
throwing away no-longer-coincident results.
This enables loading and saving the whole spectrogram.
------------------------------------------------------------------------
If bar left or right are on-screen, add time legend.
------------------------------------------------------------------------
For a file selector in Enlightenment, it needs to use ELM not just EVAS.
docs.enlightenment.org/elementary/1.15.0/fileselector_example_8c-example.html
------------------------------------------------------------------------
Add --fit to fit the audio to the whole window in length with
playing position half way.
------------------------------------------------------------------------
Make Shift L or R make barlines that are always 3 pixels thick.
------------------------------------------------------------------------
Rework barline code to place at appropriate column, not at constant
multiple of a number of pixels.
Exmple_ spettro swoop.wav
l Ctrl-Shift-RightArrow r x
The last barline no longer coincides with the end of the piece.
------------------------------------------------------------------------
Add logmax to status line, next to dynamic range.
Show dynrange and max db?
------------------------------------------------------------------------
With -t argument, round it to a multiple of step
------------------------------------------------------------------------
cache.c:128 clang reports constant condition at window == -1
------------------------------------------------------------------------
Check that the starting time and bar times are within the audio.
------------------------------------------------------------------------
Using a palettized video mode may be interesting.
------------------------------------------------------------------------
